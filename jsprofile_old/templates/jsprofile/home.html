{% extends "jsprofile/base.html" %}
{% block extrahead %} 
<link rel="stylesheet" href="{{ STATIC_URL }}js/datepicker/datepicker.css" />
<link href="{{STATIC_URL}}jsprofile_static/xeditable/bootstrap-editable.css" rel="stylesheet"/>  
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/bootstrap-wysihtml5.css"></link>
<style type="text/css">
.bs-sidebar.affix {
  position: static;
}
.sideheading{
background-color: #e0e0e0;
background-image: -moz-linear-gradient(#fafafa, #e0e0e0);
background-image: -webkit-linear-gradient(#fafafa, #e0e0e0);
background-image: linear-gradient(#fafafa, #e0e0e0);
background-repeat: repeat-x;
display: block;
padding: 10px 10px;
border-bottom: 1px solid #ccc;
color: #222;
font-weight: bold;
font-size: 20px;
line-height: 20px;
border-left: 0 none;
}
/* First level of nav */
.bs-sidenav {  
  /*margin-bottom: 30px;*/
  padding-top:    10px;
  padding-bottom: 10px;
  background-color: #fafafa;
  border-radius: 5px;
  border:1px solid #CCC;
}

/* All levels of nav */
.bs-sidebar .nav > li > a {
  font-size: 1.2em;
  display: block;
  color: #716b7a;
  padding: 10px 20px;
  border-right: 4px solid transparent;
}
.bs-sidebar .nav > li > a:hover,
.bs-sidebar .nav > li > a:focus {
  text-decoration: none;
 /* background-color: #e5e3e9;*/
background-color: #fff;
border-right: 4px solid #dbd8e0;
}
.bs-sidebar .nav > .active > a,
.bs-sidebar .nav > .active:hover > a,
.bs-sidebar .nav > .active:focus > a {
  font-weight: bold;
  color: #418cd1;
  background-color: #fff;
  border-right: 4px solid #418cd1;
}
 .xgap{
    margin-top:60px;
  }
    
/*body {
padding: 30px 0;
background-color: #2f3439;
font-family: "Noto Sans", sans-serif;
}*/
.wrap {
margin: 0 auto;
}
/* -------------------------------------
* Bar container
* ------------------------------------- */
.progress-radial {
float: left;
margin-right: 30px;
position: relative;
width: 100px;
height: 100px;
border-radius: 50%;
border: 2px solid #2f3439;
/*background-color: tomato;
*/}
/* -------------------------------------
* Optional centered circle w/text
* ------------------------------------- */
.progress-radial .overlay {
position: absolute;
width: 60px;
height: 60px;
background-color: #fffde8;
border-radius: 50%;
margin-left: 20px;
margin-top: 20px;
text-align: center;
line-height: 60px;
font-size: 16px;
}
/* -------------------------------------
* Mixin for progress-% class
* ------------------------------------- */
.progress-0 {
background-image: linear-gradient(90deg, #2f3439 50%, transparent 50%, transparent), linear-gradient(90deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-5 {
background-image: linear-gradient(90deg, #2f3439 50%, transparent 50%, transparent), linear-gradient(108deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-10 {
background-image: linear-gradient(90deg, #2f3439 50%, transparent 50%, transparent), linear-gradient(126deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-15 {
background-image: linear-gradient(90deg, #2f3439 50%, transparent 50%, transparent), linear-gradient(144deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-20 {
background-image: linear-gradient(90deg, #2f3439 50%, transparent 50%, transparent), linear-gradient(162deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-25 {
background-image: linear-gradient(90deg, #2f3439 50%, transparent 50%, transparent), linear-gradient(180deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-30 {
background-image: linear-gradient(90deg, #2f3439 50%, transparent 50%, transparent), linear-gradient(198deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-35 {
background-image: linear-gradient(90deg, #2f3439 50%, transparent 50%, transparent), linear-gradient(216deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-40 {
background-image: linear-gradient(90deg, #2f3439 50%, transparent 50%, transparent), linear-gradient(234deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-45 {
background-image: linear-gradient(90deg, #2f3439 50%, transparent 50%, transparent), linear-gradient(252deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-50 {
background-image: linear-gradient(-90deg, #ff6347 50%, transparent 50%, transparent), linear-gradient(270deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-55 {
background-image: linear-gradient(-72deg, #ff6347 50%, transparent 50%, transparent), linear-gradient(270deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-60 {
background-image: linear-gradient(-54deg, #ff6347 50%, transparent 50%, transparent), linear-gradient(270deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-65 {
background-image: linear-gradient(-36deg, #ff6347 50%, transparent 50%, transparent), linear-gradient(270deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-70 {
background-image: linear-gradient(-18deg, #ff6347 50%, transparent 50%, transparent), linear-gradient(270deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-75 {
background-image: linear-gradient(0deg, #ff6347 50%, transparent 50%, transparent), linear-gradient(270deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-80 {
background-image: linear-gradient(18deg, #ff6347 50%, transparent 50%, transparent), linear-gradient(270deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-85 {
background-image: linear-gradient(36deg, #ff6347 50%, transparent 50%, transparent), linear-gradient(270deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-90 {
background-image: linear-gradient(54deg, #ff6347 50%, transparent 50%, transparent), linear-gradient(270deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-95 {
background-image: linear-gradient(72deg, #ff6347 50%, transparent 50%, transparent), linear-gradient(270deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
.progress-100 {
background-image: linear-gradient(90deg, #ff6347 50%, transparent 50%, transparent), linear-gradient(270deg, #ff6347 50%, #2f3439 50%, #2f3439);
}
</style>
{% endblock %}
{% block content %}
<div class="container-fluid" style="min-height:580px;">   

    <!-- Docs nav
    ================================================== -->
  <div class="row-fluid">
    <div class="span3">
      <div class="bs-sidebar">
    		<ul class="nav bs-sidenav">
    			<li class='sideheading'>{{ request.user.username }}</li>
          <li class="active"><a href="/ajax/profile">Dashboard</a></li>
    			{% for nav in navs %}
    			   <li{% ifequal next forloop.counter %} class="active"{% endifequal %}><a class="ajaxLoad" href="#" data-ajxurl="{{ forloop.counter }}">{{nav}}</a></li>
    			{% endfor %}			  
    		</ul>
			    <hr style="border:0; margin-bottom:50px;" >
		  </div>        
    </div>
    <div class="span9">
      <div id="myModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
        <div class="modal-body"><i class="icon-spinner icon-spin icon-large" style="font-size:3em;"></i><span style="font-size:2em;"> Loading ..........</span></div>             
      </div>         
      <div id="ajaxBox" >
        <div class="nav bs-sidenav">
          <div class="row">
            <div class="span12">
            {% if messages %}{% for message in messages %}
            <div class="alert alert-{{ message.tags }}" style="margin-left:30px;">{{message}}</div>
            {% endfor %}{% endif %}
              <h3 class="text text-info">Hi <k class="text text-warning">{{ user.first_name }}</k> welcome to iTechTalents</h3>
            </div>
          </div>
          <div class="row">
            <div class="span3">
                <div><img  class="img-polaroid" style="width:180px;height:190px;" src="{{ STATIC_URL }}{% if profilesum.0.profile_pic %}{{ profilesum.0.profile_pic }}{% else %}img/facebook-default-no-profile-pic.jpg{% endif %}" /></div><br/>
                <div>{% if profilesum.0.profile_pic %}<a href="#" id="editpicture">Edit Picture</a>&emsp;|&emsp;<a href="#removepics" role="button" data-toggle="modal" id="removeprofilepics">Remove</a>{% else %}<a href="#uploadNew" role="button" class="btn" data-toggle="modal" id="p">Upload New</a>{% endif %}</div><br/>
            </div>
            <div class="span6">
                <table class="table table-borderless" style="border:1px solid #C0C0C0;background-color:#FBFBFB;">
                  
                  <!-- <tr><th width="25%">Resume Title&emsp;</th><td>:&emsp;
                  {% if tresume %}
                      {% for detail in tresume %}
                          {% if detail.resumeTitle %}
                              {{ detail.resumeTitle }}
                          {% endif %}
                      {% endfor %}
                  {% else %}
                      {% for detail in resume %}
                          {% if detail.resumeTitle %}
                              {{ detail.resumeTitle }}
                          {% endif %}
                      {% endfor %}
                  {% endif %}</td></tr>
                  <tr><th>Resume Date&emsp;</th><td>:&emsp;
                  {% if tresume %}
                      {% for detail in tresume %}
                          {% if detail.resumeTitle %}
                              {{ detail.resumeDate }}
                          {% endif %}
                      {% endfor %}
                  {% else %}
                      {% for detail in resume %}
                          {% if detail.resumeTitle %}
                              {{ detail.resumeDate }}
                          {% endif %}
                      {% endfor %} 
                  {% endif %}</td></tr>-->
                <tr><th>Name&emsp;</th><td>:&emsp;{{user.first_name}} {{user.last_name}}</td></tr>
                <tr><th>Primary mail&emsp;</th><td>:&emsp;{{ user.email }}</td></tr>
                <tr><th>Contact no&emsp;</th><td>:&emsp;{% for detail in personal %}{% if detail.handno %}{{ detail.handno }}{% endif %}{% endfor %}</td></tr>
                <tr><th>Experience&emsp;</th><td>:&emsp;
                      {% for detail in personal %}
                          {{ detail.work_expyears }}
                      {% endfor %} years - {% for detail in personal %}{{ detail.work_expmonths }}{% endfor %} months</td></tr>
                <tr><th>Industry&emsp;</th><td>:&emsp;{% for detail in personal %}{% if detail.industry %}{{ detail.industry }}{% endif %}{% endfor %}</td></tr>
                <tr><th>Functionalarea&emsp;</th><td>:&emsp;{% for detail in personal %}{% if detail.functional_area %}{{ detail.functional_area }}{% endif %}{% endfor %}</td></tr>
                <tr><th>Key Skills&emsp;</th><td>:&emsp;{% for detail in skills %}{% if detail.skill %}{{detail.skill}}, {% endif %}{% endfor %}</td></tr>
                </table>
            </div>
            <div class="span3">
                <div class="row"><h4 class="text text-info" style="text-align:center;">Profile Completion</h4></div>
              <!-- <div class="progress progress-warning progress-striped active"><div class="bar" data-percentage="{{progress}}"></div> -->
                <div class="wrap row">
                  <div class="progress-radial progress-{{progress}}" style="margin:10px 0px 20px 70px;">
                    <div class="overlay">{{progress}}%</div>
                  </div>
                </div>
                <div class="row"><a class="btn btn-danger" href="#invite" id="fb" onclick="FacebookInviteFriends();"><i class="icon-group"></i>&nbsp;Invite your friends using Facebook</a></div>
            </div>
          </div>  
          <div class="row">
                    <div class="span12" style="padding:30px 30px 30px 50px;">
                    <h4 class="text text-info" style="text-align:left;">Profile Summary</h4>
                    <p style="text-align:justify;">&emsp;{% if profilesum %}{% for detail in profilesum %}{{detail.profile_summary|safe}}{% endfor %}{% endif %}</p>
                    </div>
          </div>
          <div class="row-fluid">
            <div class="span12" style="padding:30px;">
                        <h4 class="text text-error" style="text-align:left;">Your Active Resume:{% if tresume.0.activetext_resume %} Text Resume
                        {% else %}
                      {% for detail in resume %}
                          {% if detail.resumeTitle %}
                              {{ detail.resumeTitle }}
                          {% endif %}
                      {% endfor %}
                  {% endif %}
                        </h4>
                        {% if tresume.0.activetext_resume %}
                        <div style="margin:auto; border:1px solid grey;width:1000px; padding:20px;">{% for resume in tresume %}{{ resume.resumeFile|safe }}{% endfor %}</div>
                        {% else%}
                        {% for detail in resume %}
                        {% if detail.resumeFile %}
                        <div style="margin:auto;padding:0px;width:1000px;"><iframe src="/accounts/doc/" style="margin:auto; border:1px solid grey; width:1000px; height:800px;" frameborder="0"></iframe></div>
                        {% else %}
                        <div style="margin:auto; border:1px solid grey;text-align:center;width:1000px; "><h1> Add resume <a href="#" class="resumeactivate">here</a> and select a resume to be active.</h1></div>
                        {% endif %}
                        {% endfor %}
                        {% if not resume %}
                        <div style="margin:auto; border:1px solid grey;text-align:center;width:1000px; height:800px;"><h1> Select your active resume <a href="#" class="resumeactivate">here</a></h1></div>
                        {% endif %}
                        {% endif %}
            </div>
          </div>  
        </div>
      </div>       
    </div><!--span9-->
  </div><!--row-->
</div><!--container-->
<!-- ***************** POPUP FORM UPLOAD PHOTO ************-->
<div id="uploadNew" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <form action="/ajax/NewProfilePictures/" enctype="multipart/form-data" method="post" >{% csrf_token %}
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
<h4 id="myModalLabel">Upload New Image</h4>
</div>
<div class="modal-body">

    <input type="hidden" name="userid" value="{{user.id}}" >
        
    <p><input type="file" accept="image/*" name="uploadimage" id="uploadimage" ></p></div>

<div class="modal-footer">

<button class="btn btn-primary" data-dismiss="modal" aria-hidden="true">Close</button>
<input  class="btn btn-primary" onclick="return uploadval()" type="submit" value="Upload">

</div>
</form>
</div>
<!-- Delete Profile Pictures -->
<div id="removepics" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h4 id="myModalLabel">Remove Profile Pictures</h4>
  </div>
  <div class="modal-body"><p class="text-error">Are you sure want to remove the profile pictures ?</p></div>
  <div class="modal-footer">
    <button class="btn btn-primary" data-dismiss="modal" aria-hidden="true">Close</button>
    <button class="btn btn-primary remove" data-userid="{{request.user.id}}" data-dismiss="modal" aria-hidden="true">Yes</button>
  </div>
</div>
{% endblock %}
{% block javascript %}
<script src="http://maps.googleapis.com/maps/api/js?sensor=false&amp;libraries=places"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/datepicker/bootstrap-datepicker.js"></script>
<script src="{{STATIC_URL}}jsprofile_static/xeditable/bootstrap-editable.min.js"></script>
<script src="{{ STATIC_URL }}js/wysihtml5-0.3.0.js"></script>
<script src="{{ STATIC_URL }}js/bootstrap-wysihtml5.js"></script>
<script type="text/javascript">
$(document).ready(function() {
  $(document).on({
    ajaxStart: function() {
    //$('#ajaxBox input').attr('readonly', 'readonly');
    $('#myModal').modal('show');
    },
    ajaxStop: function() {
    //$('#ajaxBox input').removeAttr('readonly');
   $('#myModal').modal('hide');
    }
  });

	$('body').on('click','.ajaxLoad',function(e){
    e.preventDefault();
		var url='/ajax/views/?menu='+ $(this).data('ajxurl'); 
		$('#ajaxBox').load(url);
		$('.bs-sidenav > li').removeClass('active');
		$(this).parent('li').addClass('active');
	});

}); 
</script>
<script type="text/javascript">
/*setTimeout(function(){

        $('.progress .bar').each(function() {
            var me = $(this);
            var perc = me.attr("data-percentage");
            //TODO: left and right text handling
            var current_perc = 0;
            var progress = setInterval(function() {
                if (current_perc>=perc) {
                    clearInterval(progress);
                } else {
                    current_perc +=1;
                    me.css('width', (current_perc)+'%');
                }
                me.text((current_perc)+'%');
              }, 50);
          });
      },300);*/
function uploadval()
        {
            var e=document.getElementById('uploadimage').value;
            
            if(e=='' || e==null)
            {
                document.getElementById('uploadimage').style.borderColor = "#FF0000";
                return false;
            }
            else
            {
                return true;
            }
        }
$(function()
    {
        /*$("#addresume,#add1stresume").click(function()
            {
                $('.span9').load('/accounts/AddResume/');
            });*/
        $("body").on("click","#editpicture",function()
            {
                $('#ajaxBox').load('/ajax/edit_profilepic_info/');
            });
        $('body').on('click','.resumeactivate',function(){
          $('#ajaxBox').load('/ajax/views/?menu=1');
          $( ".bs-sidenav li:nth-child(2)" ).removeClass('active');
          $( ".bs-sidenav li:nth-child(3)" ).addClass('active');
        });
        $('body').on('click','.remove',function(){
          $.ajax({
            url : '/ajax/remove_profilepic_info/',
            type : 'GET',
            data : {rmprfpics : $(this).data('userid')},
            success : function (data){
              window.location='/ajax/profile/';
            }
          })
        });
        /*$("#removepicture").click(function()
            {
                $('.span9').load('/ajax/remove_profilepic_info/');
            });*/
});
</script>
<script src="http://maps.google.com/maps/api/js?libraries=places&region=uk&language=en&sensor=true"></script>
<script type="text/javascript" src="{{ STATIC_URL }}js/jquery.ui.addresspicker.js"></script>
<script src="http://connect.facebook.net/en_US/all.js"></script>
<script>
FB.init({
appId:'670203932991388',
cookie:true,
status:true,
xfbml:true
});
 
function FacebookInviteFriends()
{
FB.ui({
method: 'apprequests',
message: 'Welcome to iTechTalents',
});
}
</script>
{% endblock %}
